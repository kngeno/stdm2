before_install:   
    setup qgis dev environment 

install:
    install pip requirements
 
before_script:
    check latest codes/ commits
    check pep8 standards
    reformat to pep8 standards - autopep8/autoflake
    IF persistent, format manually
    check pep8 stats IF acceptable 
    

script:
    perform coverage tests
    OUTPUT coverage report
    Auto generate API/DOCS

after_success:
    coveralls.io
    push DOCS to docs/

  
before_deploy:
    chmod +x -R scripts

deploy:
  - provider: pages
    skip_cleanup: true
    github_token: $STDM_TOKEN  # Set in the settings page of your repository, as a secure variable
    keep_history: true
    local_dir: docs # The folder that needs to be deployed
    repo: kngeno/stdm2 # Add your username/project_name here
    target_branch: gh-pages # Tell Travis to deploy on the gh-pages branch
    on:
      branch: master

  - provider: script
    script: bash scripts/deploy_skip.sh
    skip_cleanup: true
    on:
      branch: master

  - provider: script
    script: bash scripts/deploy_master.sh
    skip_cleanup: true
    on:
      branch: master
      condition: $TRAVIS_PULL_REQUEST = false
  
  - provider: script
    script: bash scripts/deploy_tags.sh
    skip_cleanup: true
    on:
      tags: true
      branch: master
      
  - provider: releases
    user: $USER
    password: $PASSWORD
    file:
      - stdm_*.tar.gz
      - stdm_*.zip
    
    file_glob: true
    skip_cleanup: true
    on:
      tags: true
      branch: master

after_deploy:
  - ls -lah stdm_*.tar.gz stdm_*.zip

notifications: 